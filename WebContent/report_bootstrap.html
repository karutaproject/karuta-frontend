<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
<link rel="icon" type="image/png" href="karuta/img/faviconK.png"></link>
<!-- =============================================================== -->
<link id='font-family' href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
<!-- =============================================================== -->
<link rel="stylesheet" type="text/css" href="other/bootstrap-4.4.0-dist/css/bootstrap.min.css"></link>
<link rel="stylesheet" type="text/css" href="other/css/jquery-ui.css"></link>
<link rel="stylesheet" type="text/css" href="other/font-awesome/css/all.css"></link>
<link rel="stylesheet" type="text/css" href="other/colorpicker/css/evol.colorpicker.min.css"></link>
<!-- =============================================================== -->
<link rel='stylesheet' type='text/css' href='karuta/css/color.css'></link>
<link rel='stylesheet' type='text/css' href='karuta/css/karuta.css'></link>
<link rel='stylesheet' type='text/css' href='karuta/css/report.css'></link>
<link rel='stylesheet' type='text/css' href='karuta/css/batch.css'></link>
<!-- =============================================================== -->
<script src="other/js/jquery-3.3.1.min.js"></script>
<script src="other/js/popper.min.js"></script>
<script src="other/bootstrap-4.4.0-dist/js/bootstrap.min.js"></script>
<!-- =============================================================== -->
		<script>
			var pathname = window.location.pathname;
			var appliname = pathname.substring(0,pathname.substring(1).indexOf('/')+1);
			var url = "../../.." + appliname + "-config/_init.js"
			$.ajax({
				async:false,
				url: url,
				dataType: "script",
				error : function(jqxhr,textStatus) {
					alert(appliname + "-config/_init.js not found");
				}
			});
		</script>
<!-- =============================================================== -->
<script src="karuta/js/karuta.js"></script>
<script src="karuta/js/UICom.js"></script>
<script src="karuta/js/report.js"></script>
<script src="karuta/js/batch.js"></script>
<!-- =============================================================== -->
<script src="karuta/js/displayHTML.js"></script>
<script src="karuta/js/pages/karuta-page.js"></script>
<script src="karuta/js/pages/list.js"></script>
<script src="karuta/js/pages/main.js"></script>
<script src="karuta/js/pages/users.js"></script>
<!-- =============================================================== -->
<script src="karuta/js/pages/usersgroups.js"></script>
<script src="karuta/js/pages/portfoliosgroups.js"></script>
<script src="karuta/js/pages/execbatch.js"></script>
<script src="karuta/js/pages/execreport.js"></script>
<!-- =============================================================== -->
<script src="karuta/js/resources/Type_Calendar.js"></script>
<script src="karuta/js/resources/Type_Comments.js"></script>
<script src="karuta/js/resources/Type_Document.js"></script>
<script src="karuta/js/resources/Type_DocumentBlock.js"></script>
<script src="karuta/js/resources/Type_Proxy.js"></script>
<script src="karuta/js/resources/Type_Get_Proxy.js"></script>
<script src="karuta/js/resources/Type_TextField.js"></script>
<script src="karuta/js/resources/Type_TextFieldBlock.js"></script>
<script src="karuta/js/resources/Type_Field.js"></script>
<script src="karuta/js/resources/Type_Image.js"></script>
<script src="karuta/js/resources/Type_ImageBlock.js"></script>
<script src="karuta/js/resources/Type_Get_Resource.js"></script>
<script src="karuta/js/resources/Type_Get_Double_Resource.js"></script>
<script src="karuta/js/resources/Type_Get_Get_Resource.js"></script>
<script src="karuta/js/resources/Type_URL.js"></script>
<script src="karuta/js/resources/Type_URLBlock.js"></script>
<script src="karuta/js/resources/Type_Item.js"></script>
<script src="karuta/js/resources/Type_Video.js"></script>
<script src="karuta/js/resources/Type_Oembed.js"></script>
<script src="karuta/js/resources/Type_Audio.js"></script>
<script src="karuta/js/resources/Type_SendEmail.js"></script>
<script src="karuta/js/resources/Type_URL2Unit.js"></script>
<script src="karuta/js/resources/Type_URL2UnitBlock.js"></script>
<script src="karuta/js/resources/Type_URL2Portfolio.js"></script>
<script src="karuta/js/resources/Type_URL2PortfolioBlock.js"></script>
<script src="karuta/js/resources/Type_Dashboard.js"></script>
<script src="karuta/js/resources/Type_Report.js"></script>
<script src="karuta/js/resources/Type_BatchForm.js"></script>
<script src="karuta/js/resources/Type_Color.js"></script>
<script src="karuta/js/resources/Type_Variable.js"></script>
<!-- =============================================================== -->
<script src="karuta/js/model/Type_Portfolio.js"></script>
<script src="karuta/js/model/Type_PortfolioFolder.js"></script>
<script src="karuta/js/model/Type_PortfoliosGroup.js"></script>
<script src="karuta/js/model/Type_Node.js"></script>
<script src="karuta/js/model/Type_Node_metadata.js"></script>
<script src="karuta/js/model/Type_Node_menus.js"></script>
<script src="karuta/js/model/Type_User.js"></script>
<script src="karuta/js/model/Type_UsersGroup.js"></script>
<!-- =============================================================== -->
<script src="application/js/version.js"></script>
<script src="karuta/js/version.js"></script>
<!-- =============================================================== -->
<script src="karuta/js/SVGToIMG.js"></script>
<script src="karuta/js/export.js"></script>
<!-- =============================================================== -->
<script src="other/html2canvas/html2canvas.js"></script>
<script src="other/html2canvas/html2canvas.svg.js"></script>
<!-- =============================================================== -->		
<script src="karuta/js/resources/Type_Bubble.js"></script>
<!-- =============================================================== -->		
<script src="karuta/js/resources/Type_EuropassL.js"></script>
<!-- =============================================================== -->
<!--link rel='stylesheet' type='text/css' href='application/css/specific.css'></link-->
<!-- =============================================================== -->
<!--  script src="other/js/jquery-ui-1.10.3.custom.min.js"></script-->
<!--script src="other/js/jquery.ui.touch-punch.min.js"></script-->
<!-- =============================================================== -->
<script src="other/js/spin.js"></script>
<script src="other/js/jquery.spin.js"></script>
<!-- =============================================================== -->
<link rel="stylesheet" type="text/css" href="other/wysihtml5/bootstrap3-wysihtml5.min.css"></link>
<link rel="stylesheet" type="text/css" href="other/css/wysiwyg-color.css"></link>
<script src="other/wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
<!-- =============================================================== -->
<script src="other/js/jquery_hotkeys.js"></script>
<script src="other/js/JQueryRC4.js"></script>
<script src="other/js/jquery.ui.widget.js"></script>
<!-- =============================================================== -->
<script src="other/colorpicker-master/js/evol-colorpicker.min.js"></script>
<!-- =============================================================== -->
<script src="other/js/jquery.iframe-transport.js"></script>
<script src="other/js/jquery.fileupload.js"></script>
<!-- =============================================================== -->
<script src="other/bootstrap-datepicker/bootstrap-datepicker.js"></script>
<script src="other/bootstrap-datepicker/bootstrap-datepicker.fr.js"></script>
<link rel="stylesheet" type="text/css" href="other/bootstrap-datepicker/datepicker.css"></link>
<!-- =============================================================== -->
<script src="other/js/js.cookie.js"></script>
<script src="other/js/jquery.sortElements.js"></script>
<!-- =============================================================== -->
<script src="other/js/jquery-qrcode-0.14.0.js"></script>
<!-- =============================================================== -->

<script>
for (var i=0; i<languages.length; i++){
	$.ajax({
		async:false,
		type : "GET",
		dataType : "script",
		url : "karuta/js/languages/locale_"+languages[i]+".js"
	});
}

var display = function(uuid, dashuuid)
{
	var depth = 1;
	var edit = true;
	var langcode = 0;
	var cb = function(data){
		UICom.parseStructure(data);
		setVariables(data);
		g_userroles[0] = g_userroles[1] = $("asmRoot",data).attr("role");
		var dashboard_div = "<div id='dashboard_"+dashuuid+"' class='createreport col-md-offset-1 col-md-11'></div>";
		$("#contenu").append(dashboard_div);
		genDashboardContent('dashboard_'+dashuuid,dashuuid,data,data);
		console.log("--ok");
	};
	$.ajax({
		type: "GET",
		url: serverBCK_API+"/portfolios/portfolio/"+uuid+"?resources=true",
		success: cb,
		dataType: 'text xml',
	});
};

var cb_start = function(data)
{
	// Needed parameter: code, find which portfolio id from it
	// Check list parameter, if exist, show uuid list
	// If uuid given, display asked one
	var q = window.location.search.slice(1).split('#')[0];
	var arr = q.split('&');
	var params = {};
	for(var i=0; i<arr.length; ++i){
		var a = arr[i].split('=');
		params[a[0]] = a[1];
	}

	USER = new UIFactory["User"]($("user",data));

	var uuid = params['uuid'];
	var dashid = params['dashid'];
	display(uuid, dashid);
};

$.ajax({
	type : "GET",
	dataType : "xml",
	url : serverBCK_API+"/credential",
	data: "",
	success : cb_start,
});
</script>


</head>
<body>
<div id="contenu"></div></body>
<div id="alert-window-footer" class="model-footer"></div>
</html>
